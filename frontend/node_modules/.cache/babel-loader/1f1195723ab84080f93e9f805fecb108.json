{"ast":null,"code":"import _asyncToGenerator from\"D:/myFishProject/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"D:/myFishProject/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"D:/myFishProject/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/myFishProject/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\myFishProject\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{useAuth}from\"../context/AuthProvider\";import{saveToken,saveID}from\"./getCommonOptions\";import{useAlert}from'react-alert';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var alert=useAlert();var loginValues={email:\"\",password:\"\"};var _useState=useState(loginValues),_useState2=_slicedToArray(_useState,2),loginForm=_useState2[0],setLoginForm=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),formErrors=_useState4[0],setFormErrors=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isSubmit=_useState6[0],setIsSubmit=_useState6[1];var navigate=useNavigate();var auth=useAuth();var myHandleChange=function myHandleChange(e){e.preventDefault();var _e$target=e.target,name=_e$target.name,value=_e$target.value;setLoginForm(_objectSpread(_objectSpread({},loginForm),{},_defineProperty({},name,value)));console.log(loginForm);};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();console.log(loginForm);setFormErrors(validate(loginForm));setIsSubmit(true);data={email:loginForm.email,password:loginForm.password};fetch('http://127.0.0.1:8000/login/',{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(data)}).then(function(response){return response.json();}).then(function(res){console.log(res.data);var authToken=res.data;var userID=res.data;authToken.map(function(auths){return saveToken(auths.token);});userID.map(function(ID){return saveID(ID.user_id);});auth.login(authToken);navigate('/',{replace:true});}).catch(function(err){alert.show(\"Credentials Invalid\");});case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();useEffect(function(){console.log(formErrors);if(Object.keys(formErrors).length===0&&isSubmit){console.log(loginForm);}},[formErrors,loginForm,isSubmit]);var validate=function validate(values){var errors={};var regex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/;if(!values.email){errors.email=\"Email is required!\";}else if(!regex.test(values.email)){errors.email=\"This is not a valid email format!\";}if(!values.password){errors.password=\"Password is required\";}return errors;};var loginCreateRedirect=function loginCreateRedirect(e){e.preventDefault();navigate('/CreateAccount',{replace:true});};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"Container\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"buttonCreateLogin\",onClick:loginCreateRedirect,children:\"Don't have an account?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"inner-box\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"acc-row1\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"accHeading\",children:\"Enter Your Login Details Below...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"accParaDetail\",children:\"Enter your details below to login or continue as guest by clicking on the button below\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"loginAccForm\",children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Enter Your Email\",name:\"email\",id:\"login_email\",value:loginForm.email,onChange:myHandleChange}),/*#__PURE__*/_jsx(\"p\",{className:\"errorsClass\",children:formErrors.email}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Enter Your Password\",id:\"login_password\",name:\"password\",value:loginForm.password,onChange:myHandleChange}),/*#__PURE__*/_jsx(\"p\",{className:\"errorsClass\",children:formErrors.password}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,className:\"loginButton\",type:\"submit\",children:\"Sign In\"})]})})]})]})});}export default Login;","map":{"version":3,"sources":["D:/myFishProject/frontend/src/components/Loginpage.js"],"names":["React","useState","useEffect","useNavigate","useAuth","saveToken","saveID","useAlert","Login","alert","loginValues","email","password","loginForm","setLoginForm","formErrors","setFormErrors","isSubmit","setIsSubmit","navigate","auth","myHandleChange","e","preventDefault","target","name","value","console","log","handleSubmit","validate","data","fetch","method","headers","body","JSON","stringify","then","response","json","res","authToken","userID","map","auths","token","ID","user_id","login","replace","catch","err","show","Object","keys","length","values","errors","regex","test","loginCreateRedirect"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport {useAuth} from \"../context/AuthProvider\";\r\nimport { saveToken, saveID } from \"./getCommonOptions\";\r\nimport { useAlert } from 'react-alert';\r\n\r\n\r\nfunction Login(){\r\n    const alert=useAlert();\r\n    const loginValues={email:\"\", password:\"\"};\r\n    const [loginForm, setLoginForm]=useState(loginValues);\r\n    const [formErrors, setFormErrors]=useState({});\r\n    const [isSubmit, setIsSubmit]=useState(false);\r\n    const navigate = useNavigate()\r\n    \r\n    const auth = useAuth()\r\n\r\n    \r\n        \r\n    const myHandleChange=(e)=>{\r\n        e.preventDefault();\r\n        const {name, value}=e.target;\r\n        setLoginForm({...loginForm, [name]:value});\r\n        console.log(loginForm);\r\n    }\r\n        \r\n    const handleSubmit= async (e)=>{\r\n        e.preventDefault();\r\n        console.log(loginForm);\r\n        setFormErrors(validate(loginForm));\r\n        setIsSubmit(true);\r\n        const data={ \r\n            email:loginForm.email, password:loginForm.password}\r\n            fetch('http://127.0.0.1:8000/login/', {\r\n                method:\"POST\",\r\n                headers: {\"Content-Type\":\"application/json\",},\r\n                body: JSON.stringify(data),\r\n                \r\n                \r\n            }).then((response)=> response.json())\r\n            .then((res)=>{\r\n                console.log(res.data);\r\n                const authToken=res.data; \r\n                const userID=res.data;\r\n                \r\n                authToken.map((auths)=>{\r\n                    return saveToken(auths.token);\r\n                    \r\n                })\r\n                userID.map((ID)=>{\r\n                     return saveID(ID.user_id);\r\n                })\r\n                auth.login(authToken);\r\n                navigate('/', { replace: true });\r\n            }).catch((err)=>{\r\n                alert.show(\"Credentials Invalid\");\r\n            })\r\n                \r\n        \r\n    }\r\n\r\n    useEffect(() => {\r\n        console.log(formErrors);\r\n        if (Object.keys(formErrors).length === 0 && isSubmit) {\r\n          console.log(loginForm);\r\n        }\r\n        \r\n    }, [formErrors, loginForm, isSubmit]);\r\n\r\n    const validate = (values) => { \r\n        const errors={};\r\n        const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/;\r\n        if(!values.email){\r\n            errors.email=\"Email is required!\"; \r\n        } else if (!regex.test(values.email)) {\r\n            errors.email = \"This is not a valid email format!\";\r\n        }\r\n        if(!values.password){\r\n            errors.password=\"Password is required\";\r\n        }\r\n        return errors;\r\n    }\r\n    const loginCreateRedirect=(e)=>{\r\n        e.preventDefault();\r\n        navigate('/CreateAccount', {replace:true});\r\n    }\r\n   \r\n        return(\r\n            <div>\r\n                <div className=\"Container\">\r\n                    <button className=\"buttonCreateLogin\" onClick={loginCreateRedirect}>Don't have an account?</button>\r\n                    <div className=\"inner-box\">\r\n                        <div className=\"acc-row1\">\r\n                            <h1 className=\"accHeading\">Enter Your Login Details Below...</h1>\r\n                            <p className=\"accParaDetail\">Enter your details below to login or continue as guest by clicking on the button below</p>\r\n                        </div>\r\n                        <div className=\"loginAccForm\">\r\n                            <form>\r\n                                <input  type=\"email\" placeholder=\"Enter Your Email\"  name=\"email\" id=\"login_email\" value={loginForm.email} \r\n                                onChange={myHandleChange}  ></input>\r\n                                 <p className=\"errorsClass\">{formErrors.email}</p>\r\n                                <input  type=\"password\" placeholder=\"Enter Your Password\" id=\"login_password\" name=\"password\" value={loginForm.password} \r\n                                onChange={myHandleChange}  ></input>\r\n                                 <p className=\"errorsClass\">{formErrors.password}</p>\r\n                                <button onClick={handleSubmit} className=\"loginButton\"  type=\"submit\">Sign In</button>    \r\n                            </form>\r\n\r\n                       \r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    \r\n}\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}